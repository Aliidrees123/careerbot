# Chat loop - build messages, calls LLM, handles tool calls, and returns output